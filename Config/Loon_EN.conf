# Loon Global Configuration by Tartarus
# Author's GitHub: https://github.com/Tartarus2014
# Script Library GitHub: https://github.com/Tartarus2014/Loon-Script
# Loon Official Documentation: https://nsloon.app/docs/intro
# Loon Third-Party Plugin Center: https://hub.kelee.one
# Loon Third-Party Knowledge Base: https://t.me/ibilibili/581
# Loon Rules GitHub: https://github.com/blackmatrix7/ios_rule_script/tree/master/rule/Loon

# Import configuration.
# After importing, click https://www.nsloon.com/openloon/flowmodel=filter to switch to automatic traffic split mode.
# Then click https://www.nsloon.com/openloon/proxymode=tun to switch the proxy mode to TUN Only mode [this operation means successful switching after clicking to jump to Loon].
# Turn on the switches for [MitM], [Script], and [Rewrite].
# Turn on the [MitM over HTTP/2] and [QUIC Fallback Protection] switches in [MitM].
# Ensure Safari is the default browser, then install and trust the certificate.
# Click [Configuration] on the Loon bottom navigation bar â†’ [Â·Â·Â·] in the top right corner, and turn on the [Always On] switch.
# Add your airport subscription.
# After turning on Loon, click https://www.nsloon.com/openloon/update?sub=all to update all external resources with one click.

[General]
# IPv6 Support
ip-mode = dual
ipv6-vif = auto
# UDP related
disable-stun = true
udp-fallback-mode = REJECT
# SNI-assisted rule matching
sni-sniffing = true
# Disconnect connections when policy group switches
disconnect-on-policy-change = true
# Domain blocking behavior
domain-reject-mode = DNS
dns-reject-mode = LOOPBACKIP
# > Skip Proxy
# Skip a domain or IP range; these target hosts will not be handled by Loon Proxy.
skip-proxy = localhost, *.local, captive.apple.com, e.crashlytics.com, www.baidu.com, passenger.t3go.cn, yunbusiness.ccb.com, wxh.wo.cn, gate.lagou.com, www.abchina.com.cn, login-service.mobile-bank.psbc.com, mobile-bank.psbc.com, 10.0.0.0/8, 127.0.0.1/32, 172.16.0.0/12, 192.168.0.0/16, 192.168.122.1/32, 193.168.0.1/32, ::1/128, fe80::/10
# > Always Real IP Hosts
# DNS packets will be forwarded to the upstream DNS server.
real-ip = *.lan, *.direct, cable.auth.com, *.msftconnecttest.com, *.msftncsi.com, network-test.debian.org, detectportal.firefox.com, resolver1.opendns.com, *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, stun.*, global.turn.twilio.com, global.stun.twilio.com, app.yinxiang.com, injections.adguard.org, local.adguard.org, localhost.*.qq.com, localhost.*.weixin.qq.com, *.logon.battlenet.com.cn, *.logon.battle.net, *.blzstatic.cn, music.163.com, *.music.163.com, *.126.net, musicapi.taihe.com, music.taihe.com, songsearch.kugou.com, trackercdn.kugou.com, *.kuwo.cn, api-jooxtt.sanook.com, api.joox.com, joox.com, y.qq.com, *.y.qq.com, streamoc.music.tc.qq.com, mobileoc.music.tc.qq.com, isure.stream.qqmusic.qq.com, dl.stream.qqmusic.qq.com, aqqmusic.tc.qq.com, amobile.music.tc.qq.com, *.xiami.com, *.music.migu.cn, music.migu.cn, proxy.golang.org, *.mcdn.bilivideo.cn, *.cmpassport.com, id6.me, open.e.189.cn, opencloud.wostore.cn, id.mail.wo.cn, mdn.open.wo.cn, hmrz.wo.cn, nishub1.10010.com, enrichgw.10010.com, *.wosms.cn, *.jegotrip.com.cn, *.icitymobile.mobi, *.pingan.com.cn, *.cmbchina.com, *.10099.com.cn, *.microdone.cn, pool.ntp.org, *.pool.ntp.org, ntp.*.com, time.*.com, ntp?.*.com, time?.*.com, time.*.gov, time.*.edu.cn, *.ntp.org.cn, PDC._msDCS.*.*, DC._msDCS.*.*, GC._msDCS.*.*
# Bypass TUN
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.18.0.0/15,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32
# DNS Server
dns-server = 223.5.5.5,180.184.1.1
# doh-server = https://223.5.5.5/dns-query,https://8.8.8.8/dns-query
# Hijack DNS
# By default, Loon only returns fake IP addresses (198.18.0.2) for DNS queries sent to the Loon DNS address.
# Some devices or software always use hardcoded DNS servers (e.g., Google Speakers always use 8.8.8.8). You can use this option to hijack queries to get a fake address.
hijack-dns = 8.8.8.8:53,8.8.4.4:53
# Wi-Fi Access
allow-wifi-access = false
wifi-access-http-port = 1234
wifi-access-socks5-port = 1235
mitm-on-wifi-access = false
# Proxy Test URL
internet-test-url = http://connectivitycheck.platform.hicloud.com/generate_204
proxy-test-url = http://detectportal.firefox.com/success.txt
# Test Timeout (s)
test-timeout = 5
# Network Interface
interface-mode = auto
# ssid-trigger parameter, used to specify traffic mode switching under SSID. (default means default, cellular means cellular, currently supports three values: rule, direct, proxy)
# ssid-trigger = "default":rule, "cellular":rule,"ASUS_5G":direct
# geoip and asn
geoip-url = https://raw.githubusercontent.com/Masaiki/GeoIP2-CN/release/Country.mmdb
ipasn-url = https://raw.githubusercontent.com/P3TERX/GeoLite.mmdb/download/GeoLite2-ASN.mmdb
# Parser
resource-parser = https://raw.githubusercontent.com/sub-store-org/Sub-Store/release/sub-store-parser.loon.min.js

[Host]

[Proxy]

[Remote Proxy]
æœºåœºè®¢é˜… = https://suo.yt/W7BkpTS

[Proxy Group]
FINAL = select, DIRECT, èŠ‚ç‚¹é€‰æ‹©, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png
èŠ‚ç‚¹é€‰æ‹© = select, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Proxy.png
è‹¹æœæœåŠ¡ = select, DIRECT, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
å¥ˆé£è§†é¢‘ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png
æ²¹ç®¡è§†é¢‘ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
å·´å“ˆå§†ç‰¹ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bahamut.png
ç”µæŠ¥æ¶ˆæ¯ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
å›½å¤–åª’ä½“ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Streaming.png
æ¸¯å°ç•ªå‰§ = select, DIRECT, å°æ¹¾èŠ‚ç‚¹, é¦™æ¸¯èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/StreamingSE.png
é¦™æ¸¯èŠ‚ç‚¹ = select, é¦™æ¸¯, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
å°æ¹¾èŠ‚ç‚¹ = select, å°æ¹¾, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png
ç‹®åŸèŠ‚ç‚¹ = select, æ–°åŠ å¡, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
éŸ©å›½èŠ‚ç‚¹ = select, éŸ©å›½, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png
æ—¥æœ¬èŠ‚ç‚¹ = select, æ—¥æœ¬, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
ç¾å›½èŠ‚ç‚¹ = select, ç¾å›½, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png

[Remote Filter]
é¦™æ¸¯ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|HKG|Hong)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
å°æ¹¾ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|TWN|Tai|Taiwan)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
æ—¥æœ¬ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|JPN|Japan)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
éŸ©å›½ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|KOR|Korea)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
æ–°åŠ å¡ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|SGP|Singapore)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
ç¾å›½ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|USA|United States)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"

[Remote Rule]
https://raw.githubusercontent.com/ConnersHua/RuleGo/master/Surge/Ruleset/Extra/Reject/Advertising.list, policy=REJECT, tag=å»å¹¿å‘Š,enabled=false
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/TestFlight/TestFlight.list, policy=èŠ‚ç‚¹é€‰æ‹©, tag=TestFlight, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Apple/Apple.list, policy=è‹¹æœæœåŠ¡, tag=è‹¹æœæœåŠ¡, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/YouTube/YouTube.list, policy=æ²¹ç®¡è§†é¢‘, tag=æ²¹ç®¡è§†é¢‘, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Netflix/Netflix.list, policy=å¥ˆé£è§†é¢‘, tag=å¥ˆé£è§†é¢‘, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Bahamut/Bahamut.list, policy=å·´å“ˆå§†ç‰¹, tag=å·´å“ˆå§†ç‰¹, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/GlobalMedia/GlobalMedia.list, policy=èŠ‚ç‚¹é€‰æ‹©, tag=å›½å¤–åª’ä½“, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/BiliBili/BiliBili.list, policy=æ¸¯å°ç•ªå‰§, tag=å›½å†…åª’ä½“, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Telegram/Telegram.list, policy=ç”µæŠ¥æ¶ˆæ¯, tag=ç”µæŠ¥æ¶ˆæ¯, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Proxy/Proxy.list, policy=èŠ‚ç‚¹é€‰æ‹©, tag=å…¨çƒè§„åˆ™, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/Proxy/Proxy_Domain.list, policy=èŠ‚ç‚¹é€‰æ‹©, tag=å…¨çƒè§„åˆ™,enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Loon/China/China.list, policy=DIRECT, tag=å…¨çƒç›´è¿, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/master/Ruleset/GEOIP.list, policy=DIRECT, tag=GEOIP, enabled=true

[Rule]
FINAL,FINAL

[Rewrite]

[Remote Rewrite]

[Script]

[Remote Script]

[Plugin]
https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/config/Loon.plugin, enabled=false
https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.loon.plugin, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Block/Advertising.plugin, enabled=true
https://kelee.one/Tool/Loon/Lpx/LoonGallery.lpx, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Loon/Redirect/Redirect.plugin, enabled=true
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.loon.plugin, enabled=true

[Mitm]
hostname = 
ca-p12 = 
ca-passphrase = 
skip-server-cert-verify = false

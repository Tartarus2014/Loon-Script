# Loonå…¨å±€é…ç½® by Tartarus
# ä½œè€…GitHubï¼š https://github.com/Tartarus2014
# è„šæœ¬åº“GitHubï¼š https://github.com/Tartarus2014/Loon-Script
# Loonå®˜æ–¹æ–‡æ¡£ï¼šhttps://nsloon.app/docs/intro
# Loonç¬¬ä¸‰æ–¹æ’ä»¶ä¸­å¿ƒï¼šhttps://hub.kelee.one
# Loonç¬¬ä¸‰æ–¹çŸ¥è¯†åº“ï¼šhttps://t.me/ibilibili/581
# Loonè§„åˆ™GitHubï¼šhttps://github.com/blackmatrix7/ios_rule_script/tree/master/rule/Loon

# å¯¼å…¥é…ç½®ã€‚
# å¯¼å…¥å®Œæˆåç‚¹ https://www.nsloon.com/openloon/flowmodel=filter åˆ‡æ¢è‡³è‡ªåŠ¨åˆ†æµæ¨¡å¼ã€‚
# å†ç‚¹ https://www.nsloon.com/openloon/proxymode=tun åˆ‡æ¢ä»£ç†æ¨¡å¼è‡³ TUN Only æ¨¡å¼ [æ­¤æ“ä½œç‚¹å‡»è·³è½¬è‡³Loonåå³ä¸ºåˆ‡æ¢æˆåŠŸ]ã€‚
# æ‰“å¼€ï¼»MitMï¼½ï¼»è„šæœ¬ï¼½ï¼»å¤å†™ï¼½ä¸‰ä¸ªåŠŸèƒ½çš„å¼€å…³ã€‚
# æ‰“å¼€ï¼»MitMï¼½é‡Œçš„ï¼»MitM over HTTP/2ï¼½å’Œï¼»QUICå›é€€ä¿æŠ¤ï¼½å¼€å…³ã€‚
# ä¿è¯Safariæ˜¯é»˜è®¤æµè§ˆå™¨çš„æƒ…å†µä¸‹ï¼Œå®‰è£…å¹¶ä¿¡ä»»è¯ä¹¦ã€‚
# ç‚¹å‡»Loonåº•éƒ¨å¯¼èˆªæ çš„ï¼»é…ç½®ï¼½â†’ å³ä¸Šè§’çš„ï¼»â‹¯ï¼½ï¼Œæ‰“å¼€ï¼»å§‹ç»ˆå¼€å¯ï¼½çš„å¼€å…³ã€‚
# æ·»åŠ ä½ çš„æœºåœºè®¢é˜…ã€‚
# æ‰“å¼€Loonçš„å¼€å…³åå¹¶ç‚¹å‡» https://www.nsloon.com/openloon/update?sub=all ä¸€é”®æ›´æ–°æ‰€æœ‰å¤–éƒ¨èµ„æºã€‚

[General]
# IPv6 æ”¯æŒ
ip-mode = dual
ipv6-vif = auto
# UDPç›¸å…³
disable-stun = true
udp-fallback-mode = REJECT
# SNIè¾…åŠ©è§„åˆ™åŒ¹é…
sni-sniffing = true
# ç­–ç•¥ç»„åˆ‡æ¢æ—¶å…³é—­è¿æ¥
disconnect-on-policy-change = true
# åŸŸåæ‹¦æˆªè¡Œä¸º
domain-reject-mode = DNS
dns-reject-mode = LoopbackIP
# > è·³è¿‡ä»£ç†
# è·³è¿‡æŸä¸ªåŸŸåæˆ–è€… IP æ®µï¼Œè¿™äº›ç›®æ ‡ä¸»æœºå°†ä¸ä¼šç”± Loon Proxy å¤„ç†ã€‚
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,e.crashlynatics.com
# > Always Real IP Hosts
# DNS æ•°æ®åŒ…å°†è¢«è½¬å‘åˆ°ä¸Šæ¸¸ DNS æœåŠ¡å™¨ã€‚
real-ip = *.apple.com,*apple.com
# ç»•è¿‡è·¯ç”±
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32
# DNS æœåŠ¡å™¨
dns-server = 223.5.5.5,180.184.1.1
# doh-server = https://223.5.5.5/dns-query,https://8.8.8.8/dns-query
# Hijack DNS
# é»˜è®¤æƒ…å†µä¸‹ï¼ŒLoon åªè¿”å›å‘é€åˆ° Loon DNS åœ°å€çš„ DNS æŸ¥è¯¢çš„å‡ IP åœ°å€(198.18.0.2)ã€‚
# æœ‰äº›è®¾å¤‡æˆ–è½¯ä»¶æ€»æ˜¯ä½¿ç”¨ç¡¬ç¼–ç çš„ DNS æœåŠ¡å™¨ã€‚ (ä¾‹å¦‚ Google Speakers æ€»æ˜¯ä½¿ç”¨ 8.8.8.8)ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹åŠ«æŒæŸ¥è¯¢ï¼Œä»¥è·å¾—ä¸€ä¸ªå‡åœ°å€ã€‚
hijack-dns = 8.8.8.8:53,8.8.4.4:53
# Wi-Fi è®¿é—®
allow-wifi-access = false
wifi-access-http-port = 1234
wifi-access-socks5-port = 1235
mitm-on-wifi-access = false
# ä»£ç†æµ‹é€Ÿ URL
internet-test-url = http://connectivitycheck.platform.hicloud.com/generate_204
proxy-test-url = http://detectportal.firefox.com/success.txt
# æµ‹é€Ÿè¶…æ—¶ (s)
test-timeout = 5
# ç½‘ç»œæ¥å£
interface-mode = auto
# ssid-triggerå‚æ•°ï¼Œç”¨äºæŒ‡å®šSSIDä¸‹æµé‡æ¨¡å¼åˆ‡æ¢ï¼Œï¼ˆdefaultè¡¨ç¤ºé»˜è®¤ï¼Œcellularè¡¨ç¤ºèœ‚çªï¼Œç›®å‰æ”¯æŒä¸‰ç§å€¼ï¼šruleï¼Œdirectï¼Œproxyï¼‰ 
# ssid-trigger = "default":rule, "cellular":rule,"ASUS_5G":direct
# è§£æå™¨
resource-parser = https://raw.githubusercontent.com/sub-store-org/Sub-Store/release/sub-store-parser.loon.min.js

[Proxy]

[Remote Proxy]

[Proxy Group]
FINAL = select, DIRECT, èŠ‚ç‚¹é€‰æ‹©, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png
èŠ‚ç‚¹é€‰æ‹© = select, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Proxy.png
è‹¹æœæœåŠ¡ = select, DIRECT, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
å¥ˆé£è§†é¢‘ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix.png
æ²¹ç®¡è§†é¢‘ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
å·´å“ˆå§†ç‰¹ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Bahamut.png
ç”µæŠ¥æ¶ˆæ¯ = select, èŠ‚ç‚¹é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
æ¸¯å°ç•ªå‰§ = select, DIRECT, å°æ¹¾èŠ‚ç‚¹, é¦™æ¸¯èŠ‚ç‚¹, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/StreamingSE.png
é¦™æ¸¯èŠ‚ç‚¹ = select, é¦™æ¸¯, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
å°æ¹¾èŠ‚ç‚¹ = select, å°æ¹¾, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Taiwan.png
ç‹®åŸèŠ‚ç‚¹ = select, æ–°åŠ å¡, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
éŸ©å›½èŠ‚ç‚¹ = select, éŸ©å›½, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png
æ—¥æœ¬èŠ‚ç‚¹ = select, æ—¥æœ¬, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
ç¾å›½èŠ‚ç‚¹ = select, ç¾å›½, img-url = https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png

[Remote Filter]
é¦™æ¸¯ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|HKG|Hong)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
å°æ¹¾ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|TWN|Tai|Taiwan)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
æ—¥æœ¬ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|JPN|Japan)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
éŸ©å›½ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|KOR|Korea)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
æ–°åŠ å¡ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|SGP|Singapore)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"
ç¾å›½ = NameRegex, FilterKey = "^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|USA|United States)(\d+)?\b)))(?!.*((?i)å›å›½|æ ¡å›­|æ¸¸æˆ|ğŸ®|(\b(GAME)\b))).*$"

[Rule]
FINAL,FINAL

[Remote Rule]
https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/LocalAreaNetwork.list, policy=DIRECT, tag=å±€åŸŸç½‘, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Advertising.lsr, policy=REJECT, tag=å»å¹¿å‘Š,enabled=false
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/TestFlight.lsr, policy=èŠ‚ç‚¹é€‰æ‹©, tag=TestFlight, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Github.lsr, policy=èŠ‚ç‚¹é€‰æ‹©, tag=Github, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Apple.lsr, policy=è‹¹æœæœåŠ¡, tag=è‹¹æœæœåŠ¡, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/YouTube.lsr, policy=æ²¹ç®¡è§†é¢‘, tag=æ²¹ç®¡è§†é¢‘, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Netflix.lsr, policy=å¥ˆé£è§†é¢‘, tag=å¥ˆé£è§†é¢‘, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Bahamut.lsr, policy=å·´å“ˆå§†ç‰¹, tag=å·´å“ˆå§†ç‰¹, enabled=trueue
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Bilibili.lsr, policy=æ¸¯å°ç•ªå‰§, tag=å›½å†…åª’ä½“, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Telegram.lsr, policy=ç”µæŠ¥æ¶ˆæ¯, tag=ç”µæŠ¥æ¶ˆæ¯, enabled=true
https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyGFWlist.list, policy=èŠ‚ç‚¹é€‰æ‹©, tag=å…¨çƒè§„åˆ™, enabled=true
https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ProxyLite.list, policy=èŠ‚ç‚¹é€‰æ‹©, tag=å…¨çƒè§„åˆ™, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Loon/Rule/Direct.lsr, policy=DIRECT, tag=å…¨çƒç›´è¿, enabled=true
https://raw.githubusercontent.com/Tartarus2014/For-own-use/refs/heads/master/Ruleset/GEOIP.list, policy=DIRECT, tag=GEOIP_CN, enabled=true

[Host]

[Rewrite]

[Script]

[Plugin]
https://kelee.one/Tool/Loon/Lpx/LoonGallery.lpx, enabled = true
https://raw.githubusercontent.com/Peng-YM/Sub-Store/master/config/Loon.plugin, enabled=false
https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.loon.plugin, enabled=false
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/master/Plugin/Block/Advertising.lpx, enabled=true
https://kelee.one/Tool/Loon/Lpx/LoonGallery.lpx, enabled=true
https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rewrite/Loon/Redirect/Redirect.plugin, enabled=true
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.loon.plugin, enabled=true

[Mitm]
hostname = 
ca-p12 = 
ca-passphrase = 
skip-server-cert-verify = true
